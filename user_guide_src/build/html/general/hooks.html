<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Hooks - Extending the Framework Core &mdash; CodeIgniter 3.0-dev documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/ci-icon.ico"/>
    <link rel="top" title="CodeIgniter 3.0-dev documentation" href="../index.html" />
    <link rel="up" title="General Topics" href="index.html" />
    <link rel="next" title="Auto-loading Resources" href="autoloader.html" />
    <link rel="prev" title="Creating Ancillary Classes" href="ancillary_classes.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="autoloader.html" title="Auto-loading Resources"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ancillary_classes.html" title="Creating Ancillary Classes"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">CodeIgniter 3.0-dev documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">General Topics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="hooks-extending-the-framework-core">
<h1>Hooks - Extending the Framework Core<a class="headerlink" href="#hooks-extending-the-framework-core" title="Permalink to this headline">¶</a></h1>
<p>CodeIgniter&#8217;s Hooks feature provides a means to tap into and modify the
inner workings of the framework without hacking the core files. When
CodeIgniter runs it follows a specific execution process, diagramed in
the <a class="reference internal" href="../overview/appflow.html"><em>Application Flow</em></a> page. There may be
instances, however, where you&#8217;d like to cause some action to take place
at a particular stage in the execution process. For example, you might
want to run a script right before your controllers get loaded, or right
after, or you might want to trigger one of your own scripts in some
other location.</p>
<div class="section" id="enabling-hooks">
<h2>Enabling Hooks<a class="headerlink" href="#enabling-hooks" title="Permalink to this headline">¶</a></h2>
<p>The hooks feature can be globally enabled/disabled by setting the
following item in the <strong>application/config/config.php</strong> file:</p>
<div class="highlight-ci"><div class="highlight"><pre><span class="nv">$config</span><span class="p">[</span><span class="s1">&#39;enable_hooks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-a-hook">
<h2>Defining a Hook<a class="headerlink" href="#defining-a-hook" title="Permalink to this headline">¶</a></h2>
<p>Hooks are defined in the <strong>application/config/hooks.php</strong> file.
Each hook is specified as an array with this prototype:</p>
<div class="highlight-ci"><div class="highlight"><pre><span class="nv">$hook</span><span class="p">[</span><span class="s1">&#39;pre_controller&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;class&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;MyClass&#39;</span><span class="p">,</span>
        <span class="s1">&#39;function&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Myfunction&#39;</span><span class="p">,</span>
        <span class="s1">&#39;filename&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Myclass.php&#39;</span><span class="p">,</span>
        <span class="s1">&#39;filepath&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hooks&#39;</span><span class="p">,</span>
        <span class="s1">&#39;params&#39;</span>   <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;beer&#39;</span><span class="p">,</span> <span class="s1">&#39;wine&#39;</span><span class="p">,</span> <span class="s1">&#39;snacks&#39;</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p><strong>Notes:</strong></p>
<p>The array index correlates to the name of the particular hook point you
want to use. In the above example the hook point is pre_controller. A
list of hook points is found below. The following items should be
defined in your associative hook array:</p>
<ul class="simple">
<li><strong>class</strong> The name of the class you wish to invoke. If you prefer to
use a procedural function instead of a class, leave this item blank.</li>
<li><strong>function</strong> The function (or method) name you wish to call.</li>
<li><strong>filename</strong> The file name containing your class/function.</li>
<li><strong>filepath</strong> The name of the directory containing your script.
Note:
Your script must be located in a directory INSIDE your <em>application/</em>
directory, so the file path is relative to that directory. For example,
if your script is located in <em>application/hooks/</em>, you will simply use
&#8216;hooks&#8217; as your filepath. If your script is located in
<em>application/hooks/utilities/</em> you will use &#8216;hooks/utilities&#8217; as your
filepath. No trailing slash.</li>
<li><strong>params</strong> Any parameters you wish to pass to your script. This item
is optional.</li>
</ul>
<p>If you&#8217;re running PHP 5.3+, you can also use lambda/anoymous functions
(or closures) as hooks, with a simpler syntax:</p>
<div class="highlight-ci"><div class="highlight"><pre><span class="nv">$hook</span><span class="p">[</span><span class="s1">&#39;post_controller&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
<span class="p">{</span>
        <span class="cm">/* do something here */</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="multiple-calls-to-the-same-hook">
<h2>Multiple Calls to the Same Hook<a class="headerlink" href="#multiple-calls-to-the-same-hook" title="Permalink to this headline">¶</a></h2>
<p>If want to use the same hook point with more than one script, simply
make your array declaration multi-dimensional, like this:</p>
<div class="highlight-ci"><div class="highlight"><pre><span class="nv">$hook</span><span class="p">[</span><span class="s1">&#39;pre_controller&#39;</span><span class="p">][]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;class&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;MyClass&#39;</span><span class="p">,</span>
        <span class="s1">&#39;function&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;MyMethod&#39;</span><span class="p">,</span>
        <span class="s1">&#39;filename&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Myclass.php&#39;</span><span class="p">,</span>
        <span class="s1">&#39;filepath&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hooks&#39;</span><span class="p">,</span>
        <span class="s1">&#39;params&#39;</span>   <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;beer&#39;</span><span class="p">,</span> <span class="s1">&#39;wine&#39;</span><span class="p">,</span> <span class="s1">&#39;snacks&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="nv">$hook</span><span class="p">[</span><span class="s1">&#39;pre_controller&#39;</span><span class="p">][]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;class&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;MyOtherClass&#39;</span><span class="p">,</span>
        <span class="s1">&#39;function&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;MyOtherMethod&#39;</span><span class="p">,</span>
        <span class="s1">&#39;filename&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Myotherclass.php&#39;</span><span class="p">,</span>
        <span class="s1">&#39;filepath&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hooks&#39;</span><span class="p">,</span>
        <span class="s1">&#39;params&#39;</span>   <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Notice the brackets after each array index:</p>
<div class="highlight-ci"><div class="highlight"><pre><span class="nv">$hook</span><span class="p">[</span><span class="s1">&#39;pre_controller&#39;</span><span class="p">][]</span>
</pre></div>
</div>
<p>This permits you to have the same hook point with multiple scripts. The
order you define your array will be the execution order.</p>
</div>
<div class="section" id="hook-points">
<h2>Hook Points<a class="headerlink" href="#hook-points" title="Permalink to this headline">¶</a></h2>
<p>The following is a list of available hook points.</p>
<ul class="simple">
<li><strong>pre_system</strong>
Called very early during system execution. Only the benchmark and
hooks class have been loaded at this point. No routing or other
processes have happened.</li>
<li><strong>pre_controller</strong>
Called immediately prior to any of your controllers being called.
All base classes, routing, and security checks have been done.</li>
<li><strong>post_controller_constructor</strong>
Called immediately after your controller is instantiated, but prior
to any method calls happening.</li>
<li><strong>post_controller</strong>
Called immediately after your controller is fully executed.</li>
<li><strong>display_override</strong>
Overrides the <tt class="docutils literal"><span class="pre">_display()</span></tt> method, used to send the finalized page
to the web browser at the end of system execution. This permits you
to use your own display methodology. Note that you will need to
reference the CI superobject with <tt class="docutils literal"><span class="pre">$this-&gt;CI</span> <span class="pre">=&amp;</span> <span class="pre">get_instance()</span></tt> and
then the finalized data will be available by calling
<tt class="docutils literal"><span class="pre">$this-&gt;CI-&gt;output-&gt;get_output()</span></tt>.</li>
<li><strong>cache_override</strong>
Enables you to call your own method instead of the <tt class="docutils literal"><span class="pre">_display_cache()</span></tt>
method in the <a class="reference internal" href="../libraries/output.html"><em>Output Library</em></a>. This permits
you to use your own cache display mechanism.</li>
<li><strong>post_system</strong>
Called after the final rendered page is sent to the browser, at the
end of system execution after the finalized data is sent to the
browser.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Hooks - Extending the Framework Core</a><ul>
<li><a class="reference internal" href="#enabling-hooks">Enabling Hooks</a></li>
<li><a class="reference internal" href="#defining-a-hook">Defining a Hook</a></li>
<li><a class="reference internal" href="#multiple-calls-to-the-same-hook">Multiple Calls to the Same Hook</a></li>
<li><a class="reference internal" href="#hook-points">Hook Points</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ancillary_classes.html"
                        title="previous chapter">Creating Ancillary Classes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="autoloader.html"
                        title="next chapter">Auto-loading Resources</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="autoloader.html" title="Auto-loading Resources"
             >next</a> |</li>
        <li class="right" >
          <a href="ancillary_classes.html" title="Creating Ancillary Classes"
             >previous</a> |</li>
        <li><a href="../index.html">CodeIgniter 3.0-dev documentation</a> &raquo;</li>
          <li><a href="index.html" >General Topics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, British Columbia Institute of Technology.
      Last updated on Nov 06, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>